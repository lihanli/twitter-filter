// Generated by CoffeeScript 1.6.3
(function() {
  var Settings;

  Settings = (function() {
    function Settings(_sendResponse) {
      this._sendResponse = _sendResponse;
    }

    return Settings;

  })();

  _.each({
    filteredUsers: [],
    filteredPhrases: [],
    options: {}
  }, function(defaultValue, key) {
    return Settings.prototype[key] = function(newData) {
      if (newData != null) {
        util.putInLocalStorage(key, newData);
        return util.defaultResponse(this._sendResponse);
      }
      return (function() {
        var res;
        res = {};
        res[key] = util.getFromLocalStorage(key) || defaultValue;
        return this._sendResponse(res);
      }).apply(this, arguments);
    };
  });

  chrome.extension.onMessage.addListener(function(req, __, sendResponse) {
    var k, settings, v, _results;
    settings = new Settings(sendResponse);
    _results = [];
    for (k in req) {
      v = req[k];
      _results.push(settings[k](v));
    }
    return _results;
  });

  chrome.browserAction.onClicked.addListener(function(tab) {
    var optionsUrl;
    optionsUrl = chrome.extension.getURL("dist/options/index.html");
    return chrome.tabs.query({}, function(extensionTabs) {
      var found, i;
      found = false;
      i = 0;
      while (i < extensionTabs.length) {
        if (optionsUrl === extensionTabs[i].url) {
          found = true;
          chrome.tabs.update(extensionTabs[i].id, {
            selected: true
          });
        }
        i++;
      }
      if (!found) {
        return chrome.tabs.create({
          url: optionsUrl
        });
      }
    });
  });

}).call(this);
